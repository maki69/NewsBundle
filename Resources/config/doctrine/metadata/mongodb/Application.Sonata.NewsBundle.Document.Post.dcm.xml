<?xml version="1.0" encoding="utf-8"?>
<doctrine-mongo-mapping xmlns="http://doctrine-project.org/schemas/orm/doctrine-mongo-mapping" xsi="http://www.w3.org/2001/XMLSchema-instance" schemaLocation="http://doctrine-project.org/schemas/orm/doctrine-mongo-mapping http://doctrine-project.org/schemas/orm/doctrine-mongo-mapping.xsd">

    <document
        name="Application\Sonata\NewsBundle\Document\Post"
        collection="newsPost"
        repository-class="Application\Sonata\NewsBundle\Document\PostRepository">

        <field fieldName="id" id="true" />

        <reference-one
            field="author"
            target-document="Application\FOS\UserBundle\Document\User"
           >
            <cascade>
                <cascade-persist />
                <!--<cascade-merge />-->
                <!--<cascade-remove />-->
                <!--<cascade-refresh />-->
            </cascade>
        </reference-one>

        <reference-many
            field="tags"
            target-document="Application\Sonata\NewsBundle\Document\Tag"
            inversed-by="posts"
            fetch="EAGER"
            >

            <cascade>
                <cascade-persist />
                <!--<cascade-merge />-->
                <!--<cascade-remove />-->
                <!--<cascade-refresh />-->
            </cascade>
        </reference-many>

        <reference-one
            field="comments"
            target-document="Application\Sonata\NewsBundle\Document\Comment"
            mapped-by="post"
            orphan-removal="true">

            <cascade>
                <cascade-persist/>
            </cascade>

            <order-by>
                <order-by-field fieldName="createdAt" direction="DESC" />
            </order-by>
        </reference-one>

    </document>
</doctrine-mongo-mapping>